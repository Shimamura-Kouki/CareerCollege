# 2024年度 後期 プログラム基礎 期末試験

試験の回答は、以下の通りにすること。

- １問あたり１ファイルに記述。ファイル名は「問題番号.php(例: 1.php)」とする。拡張子は.phpであること
    - 問2から問8までは「連続した追加実装」のため、まとめて1ファイルにしてもよいものとする
- 文字コードはUTF-8にすること

試験の注意事項は以下の通り

- 試験なので「周囲との相談」「他人の答案の覗き見」は不許可
- ネット等を使って調べるのは許可
- コードやSQLを実行 / 確認するのは推奨
- いずれの問題も「書いてある点数(記載がない場合は10点)」を満点とし、問題があったら適宜減点する

提出は、以下の通り

- 「自分の名前+各席番号」.zip のファイル名で回答を一式固めて提出

## (問1) HTML formからの入力を出力

以下のHTML formがある。  

```
<form action="1.php" method="post">
  キャラクタ名: <input name="chara_name"><br>
  <button>送信</button>
</form>
```

このformから入力を受け取り、キャラクタ名をechoで出力するコードを書きなさい。  
なお、セキュリティへの配慮がない場合は減点とする。  

## (問2) キャラクタの作成

以下のhash配列を返す関数を作成しなさい。  

関数名: makeChara
引数: string 名前
処理: 
- `name`, `STR`, `DEX`, `MaxHP`, `HP` の5つのkeyをもつhash配列を作成する
- `name` には、引数 $name の値を代入する
- `STR`, `DEX` には、 3d6 で作成した値を代入する
- `MaxHP` には、 8d8 で作成した値を代入する
- `HP` には、 `MaxHP` と同じ値を代入する
- 作成したhash配列を返す

## (問3) キャラクタの出力

問2で作成した関数を使って作られたキャラクタ情報を出力しなさい。  
出力のフォーマットはある程度任意だが、例えば以下のような感じを想定している(数値や名前は適当)。  

```
名前: てすと太郎
STR: 12
DEX: 15
HP: 40/40
```

関数名: printChara    
引数: array キャラクタ情報  
処理: 
- 各情報を出力する

なお、セキュリティへの配慮がない場合は減点とする。  

## (問4) ダメージ処理

問2で作成した関数を使って作られたキャラクタ情報に対して「ダメージを与える(HPを減算する)」関数を作成しなさい。

関数名: damage  
引数: array キャラクタ情報, int ダメージ  
処理: 
- キャラクタ情報のHPから、引数のダメージの値だけ数値を減算する
    - 減算した値で、キャラクタ情報のHPを更新する
- キャラクタ情報を返す

## (問5) 生死判定

「問2で作成した関数を使って作られたキャラクタ情報」にダメージを与えた問4の情報を前提に、「生死判定」をする関数を作成しなさい。

関数名: isAlive  
引数: array キャラクタ情報  
処理:   
- キャラクタ情報のHPを確認する
    - HPが1以上なら true を返す
    - HPが0以下なら false を返す

## (問6) ボーナス値の取得

キャラクタの能力値に対する「ボーナス値」を取得する関数を作成しなさい。  

関数名: getBonus  
引数: int 能力値(のうち1つ)  
処理: 
- 引数の値を3で割る(端数切り捨て)
- 上述で求められた値を int でキャストして返す

## (問7) 判定その1(上方ロール): 15点

問2で作成した関数を使って作られたキャラクタ情報を2体分使って、判定用の関数を作成しなさい。  
判定の仕様は以下の通りとする。  

- 攻撃側は、 2d6 + strボーナス
- 防御側は、 2d6 + dexボーナス
- 攻撃側が防御側よりも高い値を出したら攻撃成功。同値は攻撃失敗、防御側のほうが高い値の時も攻撃失敗(防御側有利の原則)

例1)  
攻撃側: 7(2d6) + 3(strボーナス) = 10  
防御側: 6(2d6) + 2(dexボーナス) = 8  
攻撃側のほうが数値が高いので攻撃成功  

例2)  
攻撃側: 7(2d6) + 3(strボーナス) = 10  
防御側: 7(2d6) + 4(dexボーナス) = 11  
防御側のほうが数値が高いので攻撃失敗  

関数名: judgeRollHigh  
引数: array 攻撃側キャラクタ情報, array 防御側キャラクタ情報  
処理:   
- 攻撃側の数値を計算する
    - 2d6 で乱数を作成する
    - 攻撃側のSTRのボーナス値を算出する(問6の関数を使用)
    - 上述を合計する
- 防御側の数値を計算する
    - 2d6 で乱数を作成する
    - 防御側のDEXのボーナス値を算出する(問6の関数を使用)
    - 上述を合計する
- 判定をする
    - 攻撃側のほうが数値が高い場合、true (攻撃成功)を返す
    - 同値または防御側のほうが数値が高い場合、 false (攻撃失敗)を返す


## (問8) 判定その2(下方ロール): 15点

問2で作成した関数を使って作られたキャラクタ情報を2体分使って、判定用の関数を作成しなさい。  
判定の仕様は以下の通りとする。  

- 攻撃側は、 3d6 - strボーナス
- 防御側は、 3d6 - dexボーナス
- 攻撃側が防御側よりも低い値を出したら攻撃成功。同値は攻撃失敗、防御側のほうが低い値の時も攻撃失敗(防御側有利の原則)

例1)  
攻撃側: 12(3d6) - 3(strボーナス) = 9  
防御側: 12(3d6) - 2(dexボーナス) = 10  
攻撃側のほうが数値が低いので攻撃成功  

例2)  
攻撃側: 12(3d6) - 3(strボーナス) = 9  
防御側: 10(3d6) - 2(dexボーナス) = 8  
防御側のほうが数値が低いので攻撃失敗  

関数名: judgeRollLow   
引数: array 攻撃側キャラクタ情報, array 防御側キャラクタ情報  
処理:   
- 攻撃側の数値を計算する
    - 3d6 で乱数を作成する
    - 攻撃側のSTRのボーナス値を算出する(問6の関数を使用)
    - 3d6の値からボーナス値を減算する
- 防御側の数値を計算する
    - 3d6 で乱数を作成する
    - 防御側のDEXのボーナス値を算出する(問6の関数を使用)
    - 3d6の値からボーナス値を減算する
- 判定をする
    - 攻撃側のほうが数値が低い場合、true (攻撃成功)を返す
    - 同値または防御側のほうが数値が低い場合、 false (攻撃失敗)を返す


## (問9) シンプルながちゃ: 20点

以下の確率で排出される「がちゃ」の関数を作成せよ。  

カード情報
- スライム 確率40%
- コボルト 確率30%
- ドラゴン 確率20%
- フェニックス 確率10%

前提として、以下の配列があるとする。  

```
    $gachaCardList = [
        // id, 確率, カード名
        ['id' => 1, "probability" => 40, "name" => "スライム"],
        ['id' => 2, "probability" => 30, "name" => "コボルト"],
        ['id' => 3, "probability" => 20, "name" => "ドラゴン"],
        ['id' => 4, "probability" => 10, "name" => "フェニックス"],
    ];
```

関数名: drawGacha   
引数: array (上述の)gachaCardList  
処理:   
- 引数の配列から、確率(probability)を考慮しつつ、「1枚のカード(配列)」を得る
- 得た「1枚のカード」を返す
