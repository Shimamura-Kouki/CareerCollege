# 2024年度 後期 実務 期末試験

試験の回答は、以下の通りにすること。

- １問あたり１ファイルに記述。ファイル名は「問題番号.txt(例: 1.txt)」とする。拡張子は.txtであること
- dev2.m-f.netサーバのアカウント名 + プログラムが入っているディレクトリ名を記載すること

試験の注意事項は以下の通り

- 試験なので「周囲との相談」「他人の答案の覗き見」は不許可
- ネット等を使って調べるのは許可
- コードやSQLを実行 / 確認するのは推奨
- いずれの問題も「書いてある点数(記載がない場合は10点)」を満点とし、問題があったら適宜減点する

提出は、以下の通り

- 「自分の名前+各席番号」.zip のファイル名で回答を一式固めて提出

授業中に自身のDBアカウントの作成をしていない人は、試験中に速やかに以下の方法で申し出てください。  

- Teamsのチャットで「自身のアカウント名」と「DBアカウントが必要である」旨を連絡する

## (問1) 授業で作成した問い合わせ: 30点

授業で作成した「問い合わせ」および「問い合わせ管理画面」を提出しなさい。  
授業の通りに作成をした場合、例えばアカウント名が tech_c であれば、以下の通りになる想定です。  

- アカウント名: tech_c
- ディレクトリ名: /home/tech_c/laravel_inquiry

以下の各要素を採点します(各10点)。  

- 新しく短縮URIが登録できること
- 登録した短縮URIの一覧が閲覧できること
- 短縮URIにアクセスした時に、適切に設定したURIに遷移(リダイレクト)すること

## (問2) 簡単なform入力とDBへのinsert: 50点

新しくLaravelをインストールするか、あるいは、既存にある laravel_inquiry laravel_test のいずれかへの追記で作成しなさい。  
DBを扱うため、DBの設定に注意しなさい(そのため、laravel_inquiry 配下に作るのが楽でしょう)。  
laravel_inquiry 以外に作成した場合は、ディレクトリ名を「回答」として記載しなさい。  

簡単なform入力の画面を一式作成しなさい。  
項目およびvaldate内容は以下の通りです。  

- 商品名(name)
  - 必須、255文字以内
- 単価(price)
  - 必須、1以上の整数
- 販売開始日(start_date)
  - 日付(YYYY-MM-DDのフォーマット)またはNULL

この処理のためのDBテーブルを用意しなさい。  
テーブルの作成は、Laravelの流儀に則って、マイグレーションファイルを作成しなさい。  

- テーブル名: exam_items
  - カラム: id PRIMARY KEY
  - カラム: name VARCHAR(255)
  - カラム: price INT UNSIGNED
  - カラム: start_date DATE (NULL許可)
  - created_at および updated_at DATETIME

画面は以下の2画面を用意しなさい。  
URLは、書いてある通りにしなさい。  

- 入力画面 /exam/item/input
  - 上述の項目が入力できること
  - validateエラーの時に、エラー内容が出力されること
- 入力完了画面 /db/item/fin
  - 入力された内容のうち、名前とメールアドレスとめもが出力されること
  - DBに情報が正しくinsertされていること

採点項目は以下の通り(記載がなければ各10点)

- 入力Pageが表示されること
- validateエラーの時にエラー表示がされること
- 入力完了画面で、適切に出力されること(XSSがないこと)
- テーブルに正しくinsertされること(20点)

## (問3) 簡単なライブラリの作成とUnitTestの作成: 50点

新しくLaravelをインストールするか、あるいは、既存にある laravel_inquiry laravel_test のいずれかへの追記で作成しなさい。  
laravel_inquiry 以外に作成した場合は、ディレクトリ名を「回答」として記載しなさい。  

以下のライブラリを作成しなさい。  
ライブラリは `namespace App\Domain;` に作成しなさい。

クラス名: `Validator`  
メソッド: `isValidMemberId(string $member_id): bool`  
仕様:
- 全体が「半角の英数」だけで構成されていること
- 1文字目は「英子文字」であること
- 先頭2～4文字は「英字」であること
- 英字に続いて、4～6文字は「数字」であること
- 上述に合致しなければfalse(invalid)、合致すればtrue(valid)を返す

参考としては、以下が期待される。  
- ab1234 : 正。「先頭1文字目が英子文字」「先頭2文字が英字」「続く4文字の数字」のため
- abCD123456 : 正。「先頭1文字目が英子文字」「先頭4文字が英字」「続く6文字の数字」のため
- ab123 : 誤。「先頭1文字目が英子文字」「先頭2文字が英字」のあと、数字が3文字しかないため
- ab1234a : 誤。「先頭1文字目が英子文字」「先頭2文字が英字」「続く4文字の数字」の後に、定義されていない「英字」があるため
- Ab1234 : 正。「先頭1文字目が英子文字」のルールに反しているため

また、上述ライブラリに対するUnitTestを作成しなさい。  
UnitTestは、ライブラリに対して適切な箇所に記述しなさい。  
また、最低でも以下の内容をテストしなさい。  
(採点は、UnitTestが正しく動いていることを確認します: 各10点)  

- 正しいID
  - 先頭2文字の英字 + 4文字の数字
  - 先頭4文字の英字 + 6文字の数字
- 誤ったID
  - 先頭が「英子文字以外」
  - 先頭の英字が5文字(以上)
  - 後ろの数字が3文字以下

